# Project Harmony 文档维护规范

**版本：** 1.0  
**生效日期：** 2026年2月10日  
**适用范围：** 所有 project-harmony-gdd 仓库的文档贡献者

---

## 一、文档命名规范

### 1.1 核心设计文档

**格式：** `[主题].md` 或 `[主题]_Documentation.md`

**示例：**
- `GDD.md` — 游戏设计文档（Game Design Document）
- `Numerical_Design_Documentation.md` — 数值设计文档
- `MetaProgressionSystem_Documentation.md` — 局外成长系统文档

**规则：**
- 使用英文命名，单词间用下划线 `_` 分隔
- 核心文档应使用描述性名称，避免版本号（版本信息在文档内部标注）
- 中文文档可使用中文命名，但应在 README 中提供英文说明

### 1.2 实现报告

**格式：** `IMPLEMENTATION_REPORT_[版本号]_[日期].md`

**示例：**
- `IMPLEMENTATION_REPORT_2.1_2.2.md` — v2.1/v2.2 实现报告
- `IMPLEMENTATION_REPORT_v3.0_2026_02_15.md` — v3.0 实现报告（2026-02-15）

**规则：**
- 使用全大写 `IMPLEMENTATION_REPORT` 前缀
- 版本号使用 `v` 前缀或直接使用数字（如 `v3.0` 或 `2.1_2.2`）
- 日期格式：`YYYY_MM_DD`（下划线分隔）

### 1.3 Bug 修复报告

**格式：** `BUG_FIX_REPORT_[版本号]_[日期].md`

**示例：**
- `BUG_FIX_REPORT_2026_02_08.md` — 2026-02-08 Bug修复报告
- `BUG_FIX_REPORT_v5.0_2026_02_08.md` — v5.0 Bug修复报告

**规则：**
- 使用全大写 `BUG_FIX_REPORT` 前缀
- 如果针对特定版本，在日期前加版本号
- 日期格式：`YYYY_MM_DD`

### 1.4 优化报告

**格式：** `[主题]_OPTIMIZATION_REPORT_[日期].md` 或 `[主题]_OPTIMIZATION_REPORT.md`

**示例：**
- `AUDIO_EFFECTS_PARAMETER_OPTIMIZATION.md` — 音频效果器参数优化
- `MUSIC_OPTIMIZATION_REPORT.md` — 音乐生成优化报告

**规则：**
- 使用全大写 `OPTIMIZATION_REPORT` 后缀
- 主题使用全大写，单词间用下划线分隔
- 日期可选，如果是一次性优化可省略

### 1.5 设计提案

**格式：** `[主题]_Proposal_v[版本号].md`

**示例：**
- `Project_Harmony_Proposal_v1.md` — 项目提案 v1
- `UI_Enhancement_Proposal_v2.md` — UI增强提案 v2

**规则：**
- 使用 `_Proposal_` 标识
- 版本号必须包含，使用 `v` 前缀
- 提案被采纳后应归档，当前版本整合进核心文档

### 1.6 版本化文档

**格式：** `[主题]_v[版本号].md` 或 `[主题]_[版本号].md`

**示例：**
- `关卡与Boss整合设计文档_v3.0.md` — 关卡设计 v3.0
- `Numerical_Design_Documentation_v1.md` — 数值设计 v1（已归档）

**规则：**
- 当前活跃版本应使用最高版本号
- 旧版本归档时保留版本号
- 如果文档持续迭代，建议在文档内部标注版本而非文件名

---

## 二、文档结构规范

### 2.1 文档头部信息

所有文档应包含以下头部信息：

```markdown
# [文档标题]

**作者：** [作者名称]  
**版本：** [版本号]  
**日期：** [YYYY年MM月DD日]  
**状态：** [草稿/审查中/已发布/已归档]

---
```

**示例：**
```markdown
# 音频效果器系统设计文档

**作者：** Manus AI  
**版本：** v5.2  
**日期：** 2026年2月9日  
**状态：** 已发布

---
```

### 2.2 文档章节结构

推荐使用以下章节结构：

1. **导言/概述** — 文档目的、背景、适用范围
2. **核心内容** — 设计方案、实现细节、数值表格等
3. **实现指南**（可选） — 如何在代码中实现该设计
4. **验证与测试**（可选） — 验证方法、测试结果
5. **后续计划**（可选） — 未来迭代方向
6. **参考文献**（可选） — 引用的其他文档或资料

### 2.3 版本变更记录

对于持续迭代的文档，应在文档末尾添加版本变更记录：

```markdown
## 版本变更记录

| 版本 | 日期 | 变更内容 | 作者 |
|------|------|---------|------|
| v3.0 | 2026-02-10 | 新增波次级精确设计，遵循"环境即教程"原则 | Manus AI |
| v2.0 | 2026-02-08 | 重构七章节脉络，引入音乐史叙事框架 | Manus AI |
| v1.0 | 2026-02-01 | 初始版本 | gdszyy |
```

---

## 三、文档归档流程

### 3.1 何时归档

以下情况应考虑归档文档：

1. **版本替代**：新版本文档发布，旧版本不再维护
2. **功能完成**：实现报告、修复报告对应的工作已完成
3. **设计废弃**：某个设计方案被放弃或被新方案替代
4. **历史记录**：提案、评估报告等阶段性文档完成使命

### 3.2 归档步骤

#### 步骤 1：确认归档范围
- 检查文档是否仍在被引用（README、GDD 等）
- 确认文档对应的功能/版本已被替代

#### 步骤 2：选择归档位置
- **实现/修复/优化报告** → `Archive/Reports/`
- **旧版设计文档** → `Docs/Archive/`
- **旧版提案** → `Archive/`
- **旧版 Boss/系统设计** → `Archive/[主题名]/`

#### 步骤 3：执行归档操作
```bash
# 使用 git mv 保留文件历史
git mv [原路径] [归档路径]

# 示例
git mv BUG_FIX_REPORT_2026_02_08.md Archive/Reports/
git mv Docs/Level_And_Boss_Design.md Docs/Archive/
```

#### 步骤 4：更新引用
- 更新 `README.md` 中的文档链接
- 更新 `Archive/INDEX.md` 索引
- 如有其他文档引用，更新为归档路径或移除引用

#### 步骤 5：提交更改
```bash
git add README.md Archive/INDEX.md
git commit -m "docs: 归档 [文档名称] — [归档原因]"
git push origin main
```

### 3.3 归档后维护

- 每次归档操作后，更新 `Archive/INDEX.md`
- 在归档文档的摘要中注明归档原因和替代文档
- 保持归档目录结构清晰，避免文件堆积

---

## 四、文档维护最佳实践

### 4.1 版本管理

**推荐做法：**
- ✅ 在文档内部标注版本号和日期
- ✅ 重大版本更新时，归档旧版本
- ✅ 使用语义化版本号（v1.0, v2.0, v2.1）

**不推荐做法：**
- ❌ 在文件名中频繁更改版本号
- ❌ 同时维护多个活跃版本
- ❌ 删除旧版本而不归档

### 4.2 文档更新

**每次更新文档时：**
1. 更新文档头部的"日期"和"版本"字段
2. 如有重大变更，在"版本变更记录"中添加条目
3. 如果文档被其他文档引用，检查引用是否需要更新
4. 提交时使用清晰的 commit message

**Commit Message 格式：**
```
docs: [操作] [文档名称] — [简要说明]

示例：
docs: 更新 GDD.md — 新增频谱相位系统章节
docs: 归档 Level_And_Boss_Design.md — 已被 v3.0 版本替代
docs: 修复 Numerical_Design_Documentation.md 中的数值错误
```

### 4.3 文档引用

**引用其他文档时：**
- 使用相对路径：`[文档名](../Docs/文档名.md)`
- 注明引用的章节或版本：`详见 [GDD.md 第3章](GDD.md#3-和弦系统)`
- 避免引用归档文档，除非明确说明"历史参考"

**被引用的文档：**
- 在重大变更前，搜索仓库中的引用：`git grep "文档名"`
- 确保所有引用在变更后仍然有效

### 4.4 文档审查

**发布前检查清单：**
- [ ] 文档头部信息完整（作者、版本、日期、状态）
- [ ] 章节结构清晰，符合规范
- [ ] 所有内部链接和引用有效
- [ ] 表格格式正确，数据准确
- [ ] 代码示例可运行（如有）
- [ ] 无明显的拼写或语法错误
- [ ] 版本变更记录已更新（如适用）

---

## 五、特殊文档类型规范

### 5.1 README.md

**更新频率：** 每次重大变更或归档操作后

**必须包含的内容：**
- 项目简介
- 版本号和最后更新日期
- 仓库结构图
- 核心文档链接
- 开发规范

**更新时注意：**
- 保持仓库结构图与实际目录一致
- 更新"最新修复"、"最新设计"等动态链接
- 归档操作后，移除对已归档文档的直接引用

### 5.2 GDD.md

**更新频率：** 持续迭代，作为"实时文档"（Live Document）

**版本管理：**
- 使用内部版本号（如 v2.5.2）
- 不归档旧版本，而是在文档内部追加新内容
- 如需保留历史快照，可在重大版本发布时创建副本

**更新原则：**
- 新增内容追加到相应章节
- 废弃内容标注"已废弃"而非直接删除
- 保持文档的连贯性和可读性

### 5.3 TODO.md

**位置：** `godot_project/TODO.md`

**更新频率：** 每次代码提交时同步更新

**状态标记：**
- ✅ 已完成
- 🔲 部分完成
- ⬜ 未开始
- ❌ 已取消

**更新规则：**
- 每次新增功能，添加对应条目并标记为 ✅
- 每次修复 Bug，更新受影响条目的状态
- 归档或删除功能时，在 TODO 中注明

---

## 六、文档工具与自动化

### 6.1 推荐工具

- **Markdown 编辑器**：VS Code + Markdown All in One 插件
- **表格生成**：[Tables Generator](https://www.tablesgenerator.com/markdown_tables)
- **图表绘制**：Mermaid（支持在 Markdown 中嵌入）
- **文档预览**：GitHub 自动渲染 Markdown

### 6.2 自动化检查（未来计划）

考虑引入以下自动化检查：
- 文档头部信息完整性检查
- 内部链接有效性检查
- 归档文档引用检测
- 版本号一致性检查

---

## 七、常见问题（FAQ）

### Q1: 何时应该创建新文档，何时应该更新现有文档？

**A:** 
- **创建新文档**：引入全新系统、提出新提案、记录新版本的实现
- **更新现有文档**：修正错误、补充细节、迭代现有设计

### Q2: 如果文档被多个版本引用，如何归档？

**A:** 
1. 先更新所有引用该文档的地方
2. 在归档文档中添加"替代文档"说明
3. 在 Archive/INDEX.md 中记录归档原因和替代方案

### Q3: 中文文档和英文文档如何协调？

**A:** 
- 核心设计文档优先使用英文，便于国际化
- 中文文档可用于详细设计和内部讨论
- 如有中英文版本，应在 README 中说明对应关系

### Q4: 如何处理临时性的笔记或草稿？

**A:** 
- 临时笔记不应提交到主分支
- 草稿可放在 `Drafts/` 目录（需在 .gitignore 中排除）
- 正式发布前，将草稿移至正式目录并更新状态

---

## 八、规范执行与监督

### 8.1 执行责任

- **文档作者**：负责遵守命名规范和结构规范
- **代码审查者**：检查文档更新是否符合规范
- **项目维护者**：定期审查归档操作和文档结构

### 8.2 规范更新

本规范本身也是迭代文档，如有改进建议：
1. 在 GitHub Issues 中提出
2. 讨论并达成共识
3. 更新本文档并通知所有贡献者

### 8.3 违规处理

如发现不符合规范的文档：
1. 第一次：提醒并协助修正
2. 第二次：要求作者自行修正
3. 持续违规：由项目维护者直接修正

---

## 九、参考资源

- **Markdown 语法**：[GitHub Flavored Markdown](https://github.github.com/gfm/)
- **语义化版本**：[Semantic Versioning 2.0.0](https://semver.org/)
- **Commit Message 规范**：[Conventional Commits](https://www.conventionalcommits.org/)
- **文档工程最佳实践**：[Write the Docs](https://www.writethedocs.org/)

---

## 十、附录：快速参考

### 文档命名速查表

| 文档类型 | 命名格式 | 示例 |
|---------|---------|------|
| 核心设计 | `[主题].md` | `GDD.md` |
| 系统文档 | `[主题]_Documentation.md` | `MetaProgressionSystem_Documentation.md` |
| 实现报告 | `IMPLEMENTATION_REPORT_[版本]_[日期].md` | `IMPLEMENTATION_REPORT_v3.0_2026_02_15.md` |
| Bug修复 | `BUG_FIX_REPORT_[版本]_[日期].md` | `BUG_FIX_REPORT_v5.0_2026_02_08.md` |
| 优化报告 | `[主题]_OPTIMIZATION_REPORT.md` | `AUDIO_EFFECTS_PARAMETER_OPTIMIZATION.md` |
| 设计提案 | `[主题]_Proposal_v[版本].md` | `UI_Enhancement_Proposal_v2.md` |
| 版本化文档 | `[主题]_v[版本].md` | `关卡与Boss整合设计文档_v3.0.md` |

### 归档路径速查表

| 文档类型 | 归档位置 |
|---------|---------|
| 实现/修复/优化报告 | `Archive/Reports/` |
| 旧版设计文档 | `Docs/Archive/` |
| 旧版提案 | `Archive/` |
| 旧版系统设计 | `Archive/[主题名]/` |

---

**文档维护是项目成功的关键。** 遵守本规范，让我们的文档清晰、一致、易于维护！
